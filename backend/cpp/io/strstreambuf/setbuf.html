std::strstreambuf::setbuf









From cppreference.com





[edit] Input/output library

I/O manipulators

Print functions (C++23)

C-style I/O

Buffers

basic_streambuf

basic_filebuf

basic_stringbuf

basic_spanbuf(C++23)

strstreambuf(C++98/26*)

basic_syncbuf(C++20)

Streams

Abstractions

ios_base

basic_ios

basic_istream

basic_ostream

basic_iostream

File I/O

basic_ifstream

basic_ofstream

basic_fstream

String I/O

basic_istringstream

basic_ostringstream

basic_stringstream

Array I/O

basic_ispanstream(C++23)

basic_ospanstream(C++23)

basic_spanstream(C++23)

istrstream(C++98/26*)

ostrstream(C++98/26*)

strstream(C++98/26*)

Synchronized Output

basic_osyncstream(C++20)

Types

streamoff

streamsize

fpos

Error category interface

iostream_category(C++11)

io_errc(C++11)

[edit] std::strstreambuf

Public member functions

strstreambuf::strstreambuf

strstreambuf::~strstreambuf

strstreambuf::freeze

strstreambuf::str

strstreambuf::pcount

Protected member functions

strstreambuf::underflow

strstreambuf::pbackfail

strstreambuf::overflow

strstreambuf::setbuf

strstreambuf::seekoff

strstreambuf::seekpos

[edit] 





 protected:

virtual streambuf* setbuf( char* s, std::streamsize n );

 

 (deprecated in C++98) (removed in C++26) 







If s is a null pointer and n is zero, this function has no effect.

Otherwise, the effect is implementation-defined: some implementations do nothing, while some implementations deallocate the dynamic member array used as the buffer and begin using the user-supplied character array of size n, whose first element is pointed to by s.

This function is protected virtual, it may only be called through pubsetbuf() or from member functions of a user-defined class derived from std::strstreambuf.



Contents



1 Parameters

2 Return value

3 Example

4 Defect reports

5 See also





[edit] Parameters





 s



 -



 pointer to the first byte in the user-provided buffer





 n



 -



 the number of bytes in the user-provided buffer



[edit] Return value

this



[edit] Example

Implementation test to check if setbuf() is supported on a dynamic strstream (output obtained with Sun Studio):Run this code

#include <iostream>

#include <strstream>

 

int main()

{

    char a[100] = {};

    std::strstream str;

    str.rdbuf()->pubsetbuf(a, sizeof a);

    str << "Test string" << std::ends;

    std::cout << "user-provided buffer holds \"" << a << "\"\n";

}

Possible output:



user-provided buffer holds "Test string"



[edit] Defect reports

The following behavior-changing defect reports were applied retroactively to previously published C++ standards.







DR



Applied to



Behavior as published



Correct behavior





LWG 66



C++98



the effect of setbuf() was "performs an operation that isdefined separately for each class derived from strstreambuf",but there are no classes derived from strstreambuf



the effect isimplementation-defined



[edit] See also





  pubsetbuf



  invokes setbuf()  (public member function of std::basic_streambuf<CharT,Traits>) [edit]





  setbuf[virtual]



  replaces the buffer with user-defined array, if permitted  (virtual protected member function of std::basic_streambuf<CharT,Traits>) [edit]





  setbuf[virtual]



  attempts to replace the controlled character sequence with an array  (virtual protected member function of std::basic_stringbuf<CharT,Traits,Allocator>) [edit]





  setbuf[virtual]



  provides user-supplied buffer or turns this filebuf unbuffered  (virtual protected member function of std::basic_filebuf<CharT,Traits>) [edit]









 





                    