std::setbuf









From cppreference.com





[edit] Input/output library

I/O manipulators

Print functions (C++23)

C-style I/O

Buffers

basic_streambuf

basic_filebuf

basic_stringbuf

basic_spanbuf(C++23)

strstreambuf(C++98/26*)

basic_syncbuf(C++20)

Streams

Abstractions

ios_base

basic_ios

basic_istream

basic_ostream

basic_iostream

File I/O

basic_ifstream

basic_ofstream

basic_fstream

String I/O

basic_istringstream

basic_ostringstream

basic_stringstream

Array I/O

basic_ispanstream(C++23)

basic_ospanstream(C++23)

basic_spanstream(C++23)

istrstream(C++98/26*)

ostrstream(C++98/26*)

strstream(C++98/26*)

Synchronized Output

basic_osyncstream(C++20)

Types

streamoff

streamsize

fpos

Error category interface

iostream_category(C++11)

io_errc(C++11)

[edit] C-style I/O

Types and objects



FILE

fpos_t







stdinstdoutstderr



Functions



File access



fopen

freopen

fclose

fflush



fwide

setbuf

setvbuf







Direct input/output



fread



fwrite



Unformatted input/output



fgetcgetc

fgets

fputcputc

fputs

getchar

gets(until C++14)

putchar

puts

ungetc



fgetwcgetwc

fgetws

fputwcputwc

fputws

getwchar

putwchar

ungetwc











Formatted input



scanffscanfsscanf

vscanfvfscanfvsscanf(C++11)(C++11)(C++11)    



wscanffwscanfswscanf

vwscanfvfwscanfvswscanf(C++11)(C++11)(C++11)    





Formatted output



printffprintfsprintfsnprintf(C++11)

vprintfvfprintfvsprintfvsnprintf(C++11)    



wprintffwprintfswprintf

vwprintfvfwprintfvswprintf



File positioning

ftell

fgetpos

fseek

fsetpos

rewind

Error handling

clearerr

feof

ferror

perror

Operations on files

remove

rename

tmpfile

tmpnam



[edit] 





 Defined in header <cstdio>











 void setbuf( std::FILE* stream, char* buffer );

 

 







Sets the internal buffer to use for I/O operations performed on the C stream stream.

If buffer is not null, equivalent to std::setvbuf(stream, buffer, _IOFBF, BUFSIZ).

If buffer is null, equivalent to std::setvbuf(stream, nullptr, _IONBF, 0), which turns off buffering.



Contents



1 Parameters

2 Return value

3 Notes

4 Example

5 See also





[edit] Parameters





 stream



 -



 the file stream to set the buffer to





 buffer



 -



 pointer to a buffer for the stream to use. If a null pointer is supplied, the buffering is turned off. If not null, must be able to hold at least BUFSIZ characters



[edit] Return value

(none)



[edit] Notes

If BUFSIZ is not the appropriate buffer size, std::setvbuf can be used to change it.

std::setvbuf should also be used to detect errors, since std::setbuf does not indicate success or failure.

This function may only be used after stream has been associated with an open file, but before any other operation (other than a failed call to std::setbuf/std::setvbuf).

A common error is setting the buffer of stdin or stdout to an array whose lifetime ends before the program terminates:



int main()

{

    char buf[BUFSIZ];

    std::setbuf(stdin, buf);

} // lifetime of buf ends, undefined behavior

[edit] Example

std::setbuf may be used to disable buffering on streams that require immediate output.Run this code

#include <chrono>

#include <cstdio>

#include <thread>

 

int main()

{

    using namespace std::chrono_literals;

 

    std::setbuf(stdout, nullptr); // unbuffered stdout

    std::putchar('a'); // appears immediately on unbuffered stream

    std::this_thread::sleep_for(1s);

    std::putchar('b');

}

Output:



ab



[edit] See also





  setvbuf



  sets the buffer and its size for a file stream  (function) [edit]





 C documentation for setbuf









 





                    