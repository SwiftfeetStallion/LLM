std::basic_stringbuf[edit] Input/output library

I/O manipulators

Print functions (C++23)

C-style I/O

Buffers

basic_streambuf

basic_filebuf

basic_stringbuf

basic_spanbuf(C++23)

strstreambuf(C++98/26*)

basic_syncbuf(C++20)

Streams

Abstractions

ios_base

basic_ios

basic_istream

basic_ostream

basic_iostream

File I/O

basic_ifstream

basic_ofstream

basic_fstream

String I/O

basic_istringstream

basic_ostringstream

basic_stringstream

Array I/O

basic_ispanstream(C++23)

basic_ospanstream(C++23)

basic_spanstream(C++23)

istrstream(C++98/26*)

ostrstream(C++98/26*)

strstream(C++98/26*)

Synchronized Output

basic_osyncstream(C++20)

Types

streamoff

streamsize

fpos

Error category interface

iostream_category(C++11)

io_errc(C++11)

[edit] std::basic_stringbuf

Public member functions

basic_stringbuf::basic_stringbuf

basic_stringbuf::operator=(C++11)

basic_stringbuf::swap(C++11)

basic_stringbuf::str

basic_stringbuf::get_allocator(C++20)

basic_stringbuf::view(C++20)

Protected member functions

basic_stringbuf::underflow

basic_stringbuf::pbackfail

basic_stringbuf::overflow

basic_stringbuf::setbuf

basic_stringbuf::seekoff

basic_stringbuf::seekpos

Non-member functions

swap(std::basic_stringbuf)(C++11)

Exposition-only member functions

basic_stringbuf::init_buf_ptrs

[edit] 





 protected:

virtual pos_type seekpos( pos_type sp,



                          std::ios_base::openmode which = std::ios_base::in | std::ios_base::out );

 

 







Repositions std::basic_streambuf::gptr and/or std::basic_streambuf::pptr, if possible, to the position indicated by sp.

Effectively executes seekoff(off_type(sp), std::ios_base::beg, which).



Contents



1 Parameters

2 Return value

3 Notes

4 Example

5 Defect reports

6 See also





[edit] Parameters





 sp



 -



 stream position, such as one obtained by seekoff() or seekpos()





 which



 -



 defines whether the input sequences, the output sequence, or both are affected. It can be one or a combination of the following constants:





  Constant



  Explanation





 in



  affect the input sequence





 out



  affect the output sequence







[edit] Return value

sp on success or pos_type(off_type(-1)) on failure.



[edit] Notes

seekpos() is called by std::basic_streambuf::pubseekpos(), which is called by the single-argument versions of std::basic_istream::seekg() and std::basic_ostream::seekp().



[edit] Example

Run this code

#include <sstream>

#include <iostream>

 

struct mybuf : std::stringbuf

{

    mybuf(const std::string& str) : std::stringbuf(str) {}

 

    pos_type seekpos(pos_type sp, std::ios_base::openmode which)

    {

        std::cout << "Before seekpos(" << sp << "), size of the get area is "

                  << egptr() - eback() << " with "

                  << egptr() - gptr() << " read positions available.\n";

 

        pos_type rc = std::stringbuf::seekpos(sp, which);

 

        std::cout << "seekpos() returns " << rc << ".\nAfter the call, "

                  << "size of the get area is "

                  << egptr() - eback() << " with "

                  << egptr() - gptr() << " read positions available.\n";

 

        return rc;

    }

};

 

int main()

{

    mybuf buf("12345");

    std::iostream stream(&buf);

    stream.seekg(2);

}

Output:



Before seekpos(2), size of the get area is 5 with 5 read positions available.

seekpos() returns 2.

After the call, size of the get area is 5 with 3 read positions available.



[edit] Defect reports

The following behavior-changing defect reports were applied retroactively to previously published C++ standards.







DR



Applied to



Behavior as published



Correct behavior





LWG 375



C++98



static constant members of std::ios_base weremisspecified as members of std::basic_ios



corrected





LWG 564



C++98



if was unclear how to reposition gptr and/or pptr



they are repositioned by seekoff()



[edit] See also





  pubseekpos



  invokes seekpos()  (public member function of std::basic_streambuf<CharT,Traits>) [edit]





  seekoff[virtual]



  repositions the next pointer in the input sequence, output sequence, or both, using relative addressing  (virtual protected member function) [edit]





  seekpos[virtual]



  repositions the file position, using absolute addressing  (virtual protected member function of std::basic_filebuf<CharT,Traits>) [edit]





  seekpos[virtual]



  repositions the next pointer in the input sequence, output sequence, or both using absolute addressing  (virtual protected member function of std::strstreambuf) [edit]









 





                    