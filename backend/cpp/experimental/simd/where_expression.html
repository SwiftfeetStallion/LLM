std::experimental::where_expression









From cppreference.com





[edit] Extensions for parallelism v2

Parallel exceptions

exception_list

Additional execution policies



execution::vector_policy



execution::unsequenced_policy



Algorithms



induction

reductionreduction_plusreduction_minusreduction_multiplies

                                        



reduction_bit_andreduction_bit_orreduction_bit_xorreduction_minreduction_max

                                        



for_loopfor_loop_stridedfor_loop_nfor_loop_n_strided











execution::no_vec

execution::ordered_update_t

Task blocks

task_block

task_cancelled_exception

define_task_blockdefine_task_block_restore_thread

Data-parallel vectors

[edit] SIMD library

Main classes



simd



simd_mask



ABI tags



simd_abi::scalar

simd_abi::fixed_size    



simd_abi::native

simd_abi::compatible    



simd_abi::max_fixed_size

simd_abi::deduce



Alignment tags



element_aligned_tagelement_aligned



vector_aligned_tagvector_aligned



overaligned_tagoveraligned



Where expression



where



where_expression



const_where_expression



Casts



simd_caststatic_simd_cast







to_fixed_sizeto_compatibleto_native



splitsplit_by

concat



Algorithms



min

max



minmax

clamp



Reduction



reducehminhmax



Mask reduction



all_ofany_ofnone_ofsome_of



popcount

find_first_setfind_last_set







Traits



is_simdis_simd_mask

is_abi_tag

is_simd_flag_type



simd_size

memory_alignment

rebind_simdresize_simd



Math functions

[edit] std::experimental::where_expression

Member functions



operator=

operator+=operator-=operator*=operator/=operator%=operator&=operator|=operator^=operator<<=operator>>=  



operator++operator--

copy_from



































[edit] 





 Defined in header <experimental/simd>











 template< class M, class V >

class where_expression;

 

 (parallelism TS v2) 







The class template where_expression abstracts the notion of selected elements

of a given lvalue of arithmetic or data-parallel type. Selected elements are the elements of the lvalue (of type V) for which the corresponding element of the mask (of type M) is true. Operators applied to objects of type where_expression<M, V> are applied only to selected elements. All other elements are left unchanged.

Use the where function to construct where_expression objects.



[edit] Template parameters





 M



 -



 The mask type





 V



 -



 The value type M applies on



Valid combinations of (M, V) are:



 (simd_mask<T, Abi>, simd<T, Abi>),

 (simd_mask<T, Abi>, simd_mask<T, Abi>),

 (bool, T).



[edit] Member functions





  operator=



  assigns to selected positions  (public member function)





  operator+=operator-=operator*=operator/=operator%=operator&=operator|=operator^=operator<<=operator>>=



  compound operators  (public member function)





  operator++operator--



  increment and decrement operators  (public member function)





  copy_from



  loads from address to selected positions  (public member function)





[edit] Example

Run this code

#include <cstddef>

#include <experimental/simd>

#include <iostream>

namespace stdx = std::experimental;

 

void print(auto const& a)

{

    for (std::size_t i{}; i != std::size(a); ++i)

        std::cout << a[i] << ' ';

    std::cout << '\n';

}

 

template<class A>

stdx::simd<int, A> my_abs(stdx::simd<int, A> x)

{

    where(x < 0, x) = -x;

    return x;

}

 

int main()

{

    const stdx::native_simd<int> a([](int i) { return i - 2; });

    print(a);

    const auto b = my_abs(a);

    print(b);

}

Possible output:



-2 -1 0 1 

2 1 0 1







 





                    